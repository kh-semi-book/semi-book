<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="reservationMapper">

	<resultMap type="Reservation2" id="Reservation2_rm">
	
		<id property="bookNo" column="BOOK_NO"/>
		<result property="bookDate" column="BOOK_DATE"/> 
		<result property="checkIn" column="CHECK_IN"/> 
		<result property="checkOut" column="CHECK_OUT"/> 
		<result property="bookHeadCount" column="BOOK_HEADCOUNT"/> 
		<result property="bookPrice" column="PRICE"/> 
		<result property="roomProcess" column="ROOM_PROCESS"/> 
		<result property="roomCancleFl" column="ROOM_CANCEL_FL"/> 
		<result property="bookCardNo" column="BOOK_CARD_NO"/> 
		<result property="memberNo" column="MEMBER_NO"/> 
		<result property="guestNo" column="GUEST_NO"/> 
		<result property="promotionNo" column="PROMOTION_NO"/> 
		<result property="roomViewNo" column="ROOM_VIEW_NO"/> 
		<result property="roomTypeNo" column="ROOM_TYPE_NO"/> 
		<result property="promotionTitle" column="PROMOTION_TITLE"/> 
		<result property="roomName" column="ROOM_NAME"/> 
		<result property="roomViewName" column="ROOM_VIEW_NAME"/> 
	</resultMap>


	<!-- 예약 수 조회 -->
	<select id="selectBookCount" resultType="_int">
	SELECT COUNT(*) FROM BOOK
	WHERE MEMBER_NO = #{memberNo}
	
	</select>

	<!-- 예약 리스트 조회 -->
	<select id="selectBookList" resultType="list" resultMap="Reservation2_rm">
	SELECT TO_CHAR(BOOK_DATE,'YYYY-MM-DD')BOOK_DATE,
	   PROMOTION_TITLE, ROOM_NAME, ROOM_VIEW_NAME,
	   TO_CHAR(CHECK_IN,'YYYY-MM-DD') CHECK_IN,
	   TO_CHAR(CHECK_OUT,'YYYY-MM-DD') CHECK_OUT,
	   PRICE,ROOM_PROCESS
	FROM BOOK
	JOIN "PROMOTION" USING(PROMOTION_NO)
	JOIN "ROOM_TYPE" USING(ROOM_TYPE_NO)
	JOIN "ROOM_VIEW" USING(ROOM_VIEW_NO)
	WHERE BOOK.MEMBER_NO = #{memberNo}
	</select>
	
	<!-- 예약 조회 상세보기  -->
	<select id="reservationViewDetail" resultMap="Reservation2_rm">
	SELECT MEMBER_NAME 
	FROM BOOK
	JOIN "MEMBER" USING(MEMBER_NO)
	WHERE MEMBER_NO = {memberNo}
	</select>
</mapper>
